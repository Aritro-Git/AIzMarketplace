<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AIz Marketplace â€” Agent</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="css/styles.css" />

  <!-- Google Tag Manager (replace GTM-XXXXXXX) -->
  <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-XXXXXXX');
  </script>

  <!-- Microsoft Clarity (replace CLARITY_PROJECT_ID) -->
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y) {
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "CLARITY_PROJECT_ID");
  </script>

  <style>
    /* Agent page layout additions (kept inside agent.html to stay "one file") */
    .agentWrap{margin-top:22px; display:grid; grid-template-columns: 1.2fr 0.8fr; gap:18px;}
    .panel{
      border-radius:26px;
      border:1px solid rgba(255,255,255,0.09);
      background:rgba(255,255,255,0.02);
      backdrop-filter: blur(14px);
      padding:18px;
    }
    .crumbs{display:flex; gap:10px; align-items:center; color:rgba(230,237,247,0.60); font-size:13px; margin-top:14px;}
    .crumbs a{color:rgba(230,237,247,0.78)}
    .agentHead{display:flex; gap:16px; align-items:flex-start;}
    .agentVisual{
      width:220px; height:160px; border-radius:22px; overflow:hidden;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(255,255,255,0.02);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.04), 0 10px 30px rgba(0,0,0,0.35);
      position:relative;
    }
    .agentVisual img{width:100%; height:100%; object-fit:cover; display:block; filter:saturate(1.15) contrast(1.05);}
    .agentTitle{margin:0; font-size:44px; letter-spacing:-0.8px; line-height:1.05;}
    .agentTagline{margin:10px 0 12px; color:rgba(230,237,247,0.70); font-size:16px; line-height:1.55;}
    .metaRow{display:flex; flex-wrap:wrap; gap:10px; align-items:center; margin-top:10px;}
    .kpi{display:flex; gap:10px; align-items:center; color:rgba(230,237,247,0.78);}
    .stars{letter-spacing:2px;color:#F6D36B;}
    .divider{height:1px; background:rgba(255,255,255,0.07); margin:16px 0;}
    .grid2{display:grid; grid-template-columns: 1fr 1fr; gap:14px;}
    .hlabel{font-size:13px; color:rgba(230,237,247,0.62); margin:0 0 10px;}
    ul.clean{margin:0; padding-left:18px; color:rgba(230,237,247,0.76); line-height:1.6;}
    .stack{display:flex; flex-wrap:wrap; gap:10px;}
    .stack .chip{
      font-size:12px; padding:8px 10px; border-radius:999px;
      border:1px solid rgba(255,255,255,0.09);
      background:rgba(255,255,255,0.015);
      color:rgba(230,237,247,0.72);
    }
    .priceBox .big{font-size:28px; margin:0 0 4px;}
    .priceBox .small{margin:0; color:rgba(230,237,247,0.62); font-size:14px;}
    .actions{display:flex; flex-direction:column; gap:10px; margin-top:14px;}
    .btnFull{width:100%}
    .mutedNote{margin-top:10px; color:rgba(230,237,247,0.55); font-size:13px; line-height:1.5;}
    @media (max-width: 980px){
      .agentWrap{grid-template-columns:1fr;}
      .agentVisual{width:100%;}
      .agentTitle{font-size:38px;}
    }
  </style>
</head>

<body>
  <noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-XXXXXXX"
      height="0" width="0" style="display:none;visibility:hidden"></iframe>
  </noscript>

  <canvas id="stars"></canvas>

  <header class="topbar">
    <div class="brand">AIz<span>Marketplace</span></div>

    <nav class="navlinks">
      <a href="index.html" class="active">Agents</a>
      <a href="agent.html?id=advision">Docs</a>
      <a href="playground.html">Playground</a>
      <a href="#about">About</a>
      <a href="#start" class="cta">Start â†’</a>
    </nav>

    <div class="icons">
      <button class="iconbtn" aria-label="Cart">
        <span class="icon">ðŸ›’</span><span class="badge" id="cartCount">0</span>
      </button>
      <button class="iconbtn" aria-label="Account">ðŸ‘¤</button>
    </div>
  </header>

  <main class="container">
    <div class="crumbs">
      <a href="index.html">Marketplace</a>
      <span>â€º</span>
      <span id="crumbCategory">Marketing</span>
      <span>â€º</span>
      <span id="crumbName">Agent</span>
    </div>

    <section class="agentWrap">
      <!-- LEFT: details -->
      <div class="panel">
        <div class="agentHead">
          <div class="agentVisual">
            <img id="agentImg" alt="Agent visual" src="assets/visuals/advision.svg" />
          </div>

          <div>
            <h1 class="agentTitle" id="agentName">Loadingâ€¦</h1>
            <div class="agentTagline" id="agentTagline"></div>

            <div class="metaRow">
              <div class="kpi">
                <span class="stars">â˜…â˜…â˜…â˜…â˜…</span>
                <span id="agentRating"></span>
              </div>

              <div class="stack" id="agentBadges"></div>
            </div>
          </div>
        </div>

        <div class="divider"></div>

        <div class="grid2">
          <div>
            <p class="hlabel">What this agent does</p>
            <ul class="clean" id="agentBullets"></ul>
          </div>

          <div>
            <p class="hlabel">Integrations</p>
            <div class="stack" id="agentIntegrations"></div>
          </div>
        </div>

        <div class="divider"></div>

        <div class="grid2">
          <div>
            <p class="hlabel">Deployment</p>
            <div class="stack" id="agentDeploy"></div>
          </div>
          <div>
            <p class="hlabel">Skill profile</p>
            <div class="stack" id="agentSkill"></div>
          </div>
        </div>
      </div>

      <!-- RIGHT: pricing + actions -->
      <aside class="panel priceBox">
        <p class="hlabel">Pricing</p>
        <p class="big" id="agentPrice">â€”</p>
        <p class="small">Billed monthly. Cancel anytime.</p>

        <div class="actions">
          <button class="btn primary btnFull" id="buyBtn">Add to cart</button>
          <a class="btn btnFull" href="playground.html" id="tryBtn">Try in playground</a>
          <a class="btn btnFull" href="index.html" id="backBtn">Back to catalogue</a>
        </div>

        <div class="mutedNote">
          Tip: This is a demo marketplace. Hook your real checkout later.
          For portfolio, weâ€™ll track these clicks in GA4 + Clarity.
        </div>
      </aside>
    </section>

    <footer class="footer" style="margin-top:22px;">
      <a href="#">Security</a> Â· <a href="#">Privacy</a> Â· <a href="#">Contact</a>
    </footer>
  </main>

  <script>
    // Agent page JS kept inline to stay "one file"
    const qs = new URLSearchParams(location.search);
    const agentId = qs.get("id") || "advision";

    function pushEvent(event, params = {}) {
      window.dataLayer = window.dataLayer || [];
      window.dataLayer.push({ event, ...params });
      if (location.hostname === "localhost" || location.hostname === "127.0.0.1") {
        console.log("[dataLayer]", { event, ...params });
      }
    }

    function chip(text) {
      const el = document.createElement("span");
      el.className = "chip";
      el.textContent = text;
      return el;
    }

    function initStars() {
      const canvas = document.getElementById("stars");
      const ctx = canvas.getContext("2d");
      const DPR = Math.min(window.devicePixelRatio || 1, 2);
      let w, h, stars;

      function resize() {
        w = canvas.width = Math.floor(window.innerWidth * DPR);
        h = canvas.height = Math.floor(window.innerHeight * DPR);
        canvas.style.width = "100%";
        canvas.style.height = "100%";
        const count = Math.floor((w * h) / 280000);
        stars = Array.from({ length: count }, () => ({
          x: Math.random() * w,
          y: Math.random() * h,
          r: (Math.random() * 1.3 + 0.2) * DPR,
          a: Math.random() * 0.40 + 0.10,
          v: (Math.random() * 0.12 + 0.03) * DPR
        }));
      }

      function tick() {
        ctx.clearRect(0, 0, w, h);
        const grad = ctx.createRadialGradient(w * 0.70, h * 0.20, 0, w * 0.70, h * 0.20, Math.max(w, h) * 0.7);
        grad.addColorStop(0, "rgba(124,92,255,0.07)");
        grad.addColorStop(0.65, "rgba(124,92,255,0.02)");
        grad.addColorStop(1, "rgba(0,0,0,0)");
        ctx.fillStyle = grad;
        ctx.fillRect(0, 0, w, h);

        for (const s of stars) {
          s.y += s.v;
          if (s.y > h) { s.y = -10; s.x = Math.random() * w; }
          ctx.beginPath();
          ctx.fillStyle = `rgba(230,237,247,${s.a})`;
          ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
          ctx.fill();
        }
        requestAnimationFrame(tick);
      }

      resize();
      window.addEventListener("resize", resize);
      tick();
    }

    async function loadAgent() {
      initStars();

      const res = await fetch("data/agents.json", { cache: "no-cache" });
      const agents = await res.json();
      const agent = agents.find(a => a.id === agentId) || agents[0];

      document.title = `AIz Marketplace â€” ${agent.name}`;

      document.getElementById("crumbCategory").textContent = agent.category;
      document.getElementById("crumbName").textContent = agent.name;

      document.getElementById("agentName").textContent = agent.name;
      document.getElementById("agentTagline").textContent = agent.tagline;

      document.getElementById("agentRating").textContent =
        `${agent.rating.toFixed(2)} (${agent.reviews.toLocaleString()})`;

      document.getElementById("agentPrice").innerHTML =
        `From <strong>$${Number(agent.price_month).toFixed(2)}</strong> <span style="color:rgba(230,237,247,0.62);font-size:14px">/ month</span>`;

      const img = document.getElementById("agentImg");
      img.src = agent.visual || "assets/visuals/advision.svg";
      img.alt = `${agent.name} visual`;

      const bullets = document.getElementById("agentBullets");
      bullets.innerHTML = "";
      (agent.bullets || []).forEach(b => {
        const li = document.createElement("li");
        li.textContent = b;
        bullets.appendChild(li);
      });

      const badges = document.getElementById("agentBadges");
      badges.innerHTML = "";
      (agent.badges || []).forEach(b => badges.appendChild(chip(b)));
      badges.appendChild(chip(agent.category));
      badges.appendChild(chip(agent.deployment));

      const integ = document.getElementById("agentIntegrations");
      integ.innerHTML = "";
      (agent.integrations || []).forEach(i => integ.appendChild(chip(i)));

      const deploy = document.getElementById("agentDeploy");
      deploy.innerHTML = "";
      deploy.appendChild(chip(agent.deployment));
      deploy.appendChild(chip(agent.badges?.includes("Next-day deployment") ? "Next-day deployment" : "Standard deployment"));

      const skill = document.getElementById("agentSkill");
      skill.innerHTML = "";
      skill.appendChild(chip(agent.skill || "Hybrid"));
      skill.appendChild(chip(agent.skill === "Technical" ? "Developer-first" : "Business-friendly"));

      // analytics
      pushEvent("agent_detail_view", { agent_id: agent.id, category: agent.category });

      document.getElementById("buyBtn").addEventListener("click", () => {
        const cartCountEl = document.getElementById("cartCount");
        const current = Number(cartCountEl.textContent || "0") || 0;
        cartCountEl.textContent = String(current + 1);
        pushEvent("add_to_cart", { agent_id: agent.id, category: agent.category, source: "detail" });
      });

      document.getElementById("tryBtn").addEventListener("click", () => {
        pushEvent("try_in_playground_click", { agent_id: agent.id, category: agent.category });
      });

      document.getElementById("backBtn").addEventListener("click", () => {
        pushEvent("back_to_catalog_click", { agent_id: agent.id, category: agent.category });
      });
    }

    document.addEventListener("DOMContentLoaded", loadAgent);
  </script>
</body>
</html>
